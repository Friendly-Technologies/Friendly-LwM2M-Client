<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Friendly LWM2M client: Architecture</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Friendly LWM2M client
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('architecture_tag.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Architecture </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section describes the general structure of <b>Friendly LWM2M client</b>, the structure and purpose of its components, user interfaces and features of use.</p>
<ul>
<li><a class="el" href="architecture_tag.html#arch_overview">Overview</a></li>
<li><a class="el" href="architecture_tag.html#arch_components">Components</a></li>
<li><a class="el" href="architecture_tag.html#arch_user_interfaces">User Interfaces</a></li>
<li><a class="el" href="architecture_tag.html#arch_client_state_management">State Management</a></li>
<li><a class="el" href="architecture_tag.html#arch_registry_management">Registry Management</a></li>
<li><a class="el" href="architecture_tag.html#arch_object_management">Object Management</a></li>
<li><a class="el" href="architecture_tag.html#arch_platform_dependent">Platform Dependencies</a></li>
<li><a class="el" href="architecture_tag.html#arch_wpp_task_queue">Wpp Task Queue</a></li>
<li><a class="el" href="architecture_tag.html#arch_integration_and_flexibility">Integration and Flexibility</a></li>
<li><a class="el" href="architecture_tag.html#arch_object_maker_tools">Object Maker Tools</a></li>
<li><a class="el" href="architecture_tag.html#arch_summary">Sumary</a></li>
</ul>
<h3><a class="anchor" id="arch_overview"></a>
Overview</h3>
<p><b>Friendly LWM2M client</b>, also known as <b>Wpp</b>, is a project built upon the <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a> project, which implements the <b>Lightweight Machine to Machine (LwM2M)</b> protocol. The architecture of <b>Wpp</b> is carefully designed to provide a high-level presentation of <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a> functionalities while retaining control and flexibility.</p>
<h3><a class="anchor" id="arch_components"></a>
Components</h3>
<p>Since <b>Wpp</b> is built upon the <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a>, the existing interfaces and capabilities of <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a> affect the internal structure of <b>Wpp</b>. For a better understanding of what components should be present in <b>Wpp</b>, the <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a> interface was segregated, based on it, the necessary components for <b>Wpp</b> were created.</p>
<div class="image">
<img src="wakaama_core_api_segregation.png" alt="" width="950px"/>
</div>
<p><b>Wpp's</b> architecture is composed of several key components, each serving a distinct role:</p>
<ol type="1">
<li><b>State Management (<a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a>)</b>: This component is responsible for the initialization of the <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a> core, processing protocol states, managing server and object registrations.</li>
<li><b>Object Model (<a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a> <a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a> <a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a> <a class="el" href="classwpp_1_1Resource.html" title="The Resource class in the wpp namespace is a comprehensive and flexible class designed to handle diff...">wpp::Resource</a>)</b>: This component is at the heart of <b>Wpp's</b> architecture. It defines the representation of objects at the <b>Wpp</b> level, their structure, general functionality, and sets the interface for interaction with instances and resources of the object, updating <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a> about resource changes made by the user.</li>
<li><b>Object Registry (<a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a>)</b>: A crucial component that functions as a registry for available LwM2M objects. It manages the creation and initialization of objects and allows the user to create Instances and manage their resources.</li>
<li><b>Connection (<a class="el" href="classwpp_1_1WppConnection.html">wpp::WppConnection</a>)</b>: It defines the interface for establishing connections with the server and handling data transmission.</li>
<li><b>Platform (<a class="el" href="classwpp_1_1WppPlatform.html" title="The WppPlatform class provides a platform-specific implementation for the Wpp library.">wpp::WppPlatform</a> <a class="el" href="classwpp_1_1WppGuard.html" title="The WppGuard class provides a linker callback class that must be implemented by the user.">wpp::WppGuard</a>)</b>: This defines the interface for environment-dependent functions like memory allocation, logs printing, and time retrieval, and is entirely implemented by the user.</li>
<li><b>Utils (folder utils)</b>: Includes various tools that is used by <b>Wpp</b>.</li>
</ol>
<p>The diagram below shows the common <b>Wpp</b> components with their dependencies on <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a>. A part of the <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a> library with its components is highlighted in <b>yellow</b>, and a part of the <b>Wpp</b> library is highlighted in <b>green</b>. The dependencies of the environment and the user program from the <b>Wpp</b> library are also indicated.</p>
<div class="image">
<img src="wpp_dependencies_from_wakaama.jpg" alt="" width="650px"/>
</div>
<p>In the library, this structure has the following representation.</p>
<div class="image">
<img src="wpp_folders_structure.png" alt="" width="450px"/>
</div>
<h3><a class="anchor" id="arch_user_interfaces"></a>
User Interfaces</h3>
<p>The main interface of the library consists of two main parts:</p><ul>
<li><b>Object registry management interface.</b> Which is used by the user to initialize the client, gain access to the object register, and manage objects. It consists from the next interfaces:<ul>
<li><b>State management interface.</b> Used by the user to initialize the client, get its state, access to registry, and manage registration. It consists from <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b> class which is implemented as singleton, and it is the main entry point through which interaction with the client takes place.</li>
<li><b>Registry management interface.</b> Used by the user to gain access to the objects in the registry, register build-in objects, and get their state. It consists from <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b> class which is part of <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b>.</li>
<li><b>Object management interface.</b> Used by the user to gain access to the objects state, instances, objects business logic, and internal data. It consists from <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b>, <b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b>, <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> classes, access to <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> can be retreived through <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b> class.</li>
</ul>
</li>
<li><b>Platform dependent interface.</b> It is used by the <b>Wpp</b> and must be implemented by the user or platform. It includes an interface for establishing connection, data transfer, and platform-dependent functionality like: get time, print logs, resource access guard. It consists from the next classes: <b><a class="el" href="classwpp_1_1WppConnection.html">wpp::WppConnection</a></b>, <b><a class="el" href="classwpp_1_1WppPlatform.html" title="The WppPlatform class provides a platform-specific implementation for the Wpp library.">wpp::WppPlatform</a></b>, <b><a class="el" href="classwpp_1_1WppGuard.html" title="The WppGuard class provides a linker callback class that must be implemented by the user.">wpp::WppGuard</a></b>.</li>
</ul>
<div class="image">
<img src="wpp_simplified_structure_with_deps.png" alt="" width="950px"/>
</div>
<h3><a class="anchor" id="arch_client_state_management"></a>
State Management</h3>
<p>The <b>State Management</b> interface is presented in the form of a single class <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b>, which provides a single access point for processing the internal state of the client and the object registry. This approach allows to synchronize access to internal state changes when using the client by different threads. To create a client, the user must call the <b><a class="el" href="classwpp_1_1WppClient.html#acbb496e6d1f834b441a8d4ff17b2166e" title="Creates a WppClient with the specified client information, connection, and maximum sleep time.">wpp::WppClient::create()</a></b> method, as parameters this method accepts a structure with information about the client, through which user can set its name <b><a class="el" href="structwpp_1_1WppClient_1_1ClientInfo.html#a25cbf8d1e3dae787c6c8421cfd206e9c">wpp::WppClient::ClientInfo::endpointName</a></b>, the second parameter is an object of class <b><a class="el" href="classwpp_1_1WppConnection.html">wpp::WppConnection</a></b> that is implemented by the user.</p>
<p>Synchronization of access to the client is provided by the ownership mechanism, the client can be owned by only one program subject at a time, for this purpose a pair of methods <b><a class="el" href="classwpp_1_1WppClient.html#a071dd1e9ef32a11a5e1c532e6af0ec06" title="Takes ownership of the WppClient.">wpp::WppClient::takeOwnership()</a></b> and <b><a class="el" href="classwpp_1_1WppClient.html#a7fbfbadc32a19fb8b3df6370e73c854d" title="Gives up ownership of the WppClient.">wpp::WppClient::giveOwnership()</a></b> are used. Any actions with the client can be performed only after the <b><a class="el" href="classwpp_1_1WppClient.html#a071dd1e9ef32a11a5e1c532e6af0ec06" title="Takes ownership of the WppClient.">wpp::WppClient::takeOwnership()</a></b> method returns a valid object. After completing the manipulations with the client, the owner <b>must</b> return control over the client by calling the <b><a class="el" href="classwpp_1_1WppClient.html#a7fbfbadc32a19fb8b3df6370e73c854d" title="Gives up ownership of the WppClient.">wpp::WppClient::giveOwnership()</a></b> method. <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b> has two types of methods to take ownership <b><a class="el" href="classwpp_1_1WppClient.html#a071dd1e9ef32a11a5e1c532e6af0ec06" title="Takes ownership of the WppClient.">wpp::WppClient::takeOwnership()</a></b> and <b><a class="el" href="classwpp_1_1WppClient.html#ac8e1eb3f8542f0f0f93f3abf897a70da" title="Takes ownership of the WppClient, blocking until it becomes available.">wpp::WppClient::takeOwnershipBlocking()</a></b>, the first method works without any blocking, if the client is already owned, it returns an empty pointer, but <b><a class="el" href="classwpp_1_1WppClient.html#ac8e1eb3f8542f0f0f93f3abf897a70da" title="Takes ownership of the WppClient, blocking until it becomes available.">wpp::WppClient::takeOwnershipBlocking()</a></b> works differently, if the client is owned, it blocks its call until the client is released after which takes ownership of the client and returns a valid object.</p>
<p>The second important part of <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b> is <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> method for state processing, which when called performs three main tasks: processing packets received from the server, processing tasks from <b><a class="el" href="classwpp_1_1WppTaskQueue.html" title="Represents a task queue.">wpp::WppTaskQueue</a></b>, handling the internal state of the <a href="https://github.com/eclipse/wakaama"><b>Wakaama</b></a> library. After completion, the <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> method returns the maximum time in seconds after which the user must call this method the next time. But if after calling <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> the user creates a task <b><a class="el" href="classwpp_1_1WppTaskQueue.html" title="Represents a task queue.">wpp::WppTaskQueue</a></b> which must be called earlier than the next call of the method <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> , then in this case, the <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> method must be executed earlier than scheduled for the timely execution of the user request. It should be noted that the time returned after calling <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> is the maximum amount of time after which this method should be executed, while the minimum threshold is not set. Therefore, the user can call this method even without delays between calls. It should also be noted that the next call is timed in seconds, so there is no need to call <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> more often than once per second, although this is acceptable. It is worth noting that the <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> method can be called only after the user takes ownership of <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b>.</p>
<p>To access the registry, the client has a method <b><a class="el" href="classwpp_1_1WppClient.html#afb790e827cb2a731ec6be3a97ef1c98a" title="Gets the WppRegistry associated with the WppClient.">wpp::WppClient::registry()</a></b> that returns a registry object. Other methods and their purpose are described in the <a class="el" href="code_tag.html">Code</a> section at the following link <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b>.</p>
<h3><a class="anchor" id="arch_registry_management"></a>
Registry Management</h3>
<p>The <b>Registry management</b> interface consists of one class <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b>, which represents the registry of all existing objects in the client. Each object that exists in the client must be represented as a separate method in <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b>, for example, for the object <b><a class="el" href="classwpp_1_1Device.html">wpp::Device</a></b> there is a method <b><a class="el" href="classwpp_1_1WppRegistry.html#a45aacbf59a432300fc47b91705901b28">wpp::WppRegistry::device()</a></b> which when called, returns the corresponding object. User can also use another way to get the required object through <b><a class="el" href="namespacewpp.html#ae35ffa7d3ba976b8e0e90ffb4c973152" title="Enumeration of object IDs in the Wpp library.">wpp::OBJ_ID</a></b>, for this needs to call the <b><a class="el" href="classwpp_1_1WppRegistry.html#ada21355749fd54b5bc6c4e7967d5899b" title="Retrieves a pointer to the Object with the given objId.">wpp::WppRegistry::object()</a></b> method and pass the ID of the corresponding object. Each existing object in the client has its own unique <b>ID</b>, which is reflected in the <b><a class="el" href="namespacewpp.html#ae35ffa7d3ba976b8e0e90ffb4c973152" title="Enumeration of object IDs in the Wpp library.">wpp::OBJ_ID</a></b> enumeration. In addition to the fact that <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b> stores all objects and provides access to them, it also has a function that allows to register the corresponding objects on the server, this is a pair of methods <b><a class="el" href="classwpp_1_1WppRegistry.html#a78a0f15a78a1bb90a426cae9cf647eb5" title="Registers an Object in the registry.">wpp::WppRegistry::registerObj()</a></b> and <b><a class="el" href="classwpp_1_1WppRegistry.html#ae7ad67680ac2640301d922d7ae752601" title="Deregisters an Object from the registry.">wpp::WppRegistry::deregisterObj()</a></b>, there are also methods that allows to get the current state of the object, more details at the following link <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b>. <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b> was designed in such a way that it can be used together with a set of utilities for generating objects <a href="../../utils/object_maker"><b>object_maker</b></a>, so it is important not to disturb the internal structure and comments that exist in <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b>, and if it is necessary to do this, then it must be coordinated with utilities.</p>
<h3><a class="anchor" id="arch_object_management"></a>
Object Management</h3>
<p>The <b>Object Management</b> interface consists of four classes <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b>, <b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b>, <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>, <b><a class="el" href="classwpp_1_1Resource.html" title="The Resource class in the wpp namespace is a comprehensive and flexible class designed to handle diff...">wpp::Resource</a></b>, but the user can interact with the interfaces of only two <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b>, <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>. The above classes represent the LwM2M data model of the object, which is described in the documentation <a href="https://openmobilealliance.org/release/LightweightM2M/V1_1_1-20190617-A/OMA-TS-LightweightM2M_Core-V1_1_1-20190617-A.pdf"><b>7.1. Resource Model</b></a>. The general hierarchy is as follows: <b>LwM2M</b> has a registry with a description of each object, its resources and business logic <a href="https://technical.openmobilealliance.org/OMNA/LwM2M/LwM2MRegistry.html"><b>Object and Resource Registry</b></a>, but this representation is only in the form of text, not structure and code, therefore <b>Wpp</b> has its own representation of the registry in the form of the <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b> class, which stores instances of the data model that represents <b>LwM2M</b> objects. The mentioned data model contains <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b>, each object is a container for instances of its type <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>, each instance stores data specific to a certain object, these data are called resources <b><a class="el" href="classwpp_1_1Resource.html" title="The Resource class in the wpp namespace is a comprehensive and flexible class designed to handle diff...">wpp::Resource</a></b>, resources are structures that display fields and object values according to the <b>LwM2M</b> description.</p>
<p>For a better understanding of the structure, it is worth describing each component separately:</p><ol type="1">
<li><b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> is at the top level and defines the interface/behavior for LwM2M objects. Its main task is to manage instances (<b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>) of the object and process requests from the server with subsequent transfer of these requests to the corresponding implementation of the object. In fact, <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> is a container for instances of the <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> class, it has the following methods to manage instances: <b><a class="el" href="classwpp_1_1Object.html#a2905bb68695e421c76ed3e0740bb4089" title="Creates an instance of the object.">wpp::Object::createInstance()</a></b> to create a new instance (class instance <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>) by its <b>ID</b>, <b><a class="el" href="classwpp_1_1Object.html#a3e14100c612dfc5860793054b81a7f11" title="Removes an instance of the object.">wpp::Object::remove()</a></b> to remove an instance by its <b>ID</b>, <b><a class="el" href="classwpp_1_1Object.html#a0367aab216c8d199790ceed0d33f8608" title="Gets an instance of the object.">wpp::Object::instance()</a></b> to get the corresponding instance by its <b>ID</b>. Each instance of the <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> class stored in the <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b> has a built-in monitoring mechanism via the <b><a class="el" href="classwpp_1_1ObjSubject.html" title="The ObjSubject class represents a subject that notifies observers about object operations and actions...">wpp::ObjSubject</a></b> class (<b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> inherits from <b><a class="el" href="classwpp_1_1ObjSubject.html" title="The ObjSubject class represents a subject that notifies observers about object operations and actions...">wpp::ObjSubject</a></b>), whereby <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> receives the following method <b><a class="el" href="classwpp_1_1ObjSubject.html#a56c6897642ac500f5db97c814f9eb4ba" title="Subscribes an observer to receive notifications about object operations.">wpp::ObjSubject::opSubscribe()</a></b>, this method is used by the user to observe an object. For example, if the server wants to create an object instance (<b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>), then during this operation, if the user is subscribed to it, an event will be generated that will be sent to the user's observer. Since The user has <b><a class="el" href="classwpp_1_1ObjOpObserver.html" title="The ObjOpObserver class is an abstract base class that defines the interface for observing object ope...">wpp::ObjOpObserver</a></b> observer, which is interfaces with a set of methods that must be implemented by the user. Each method corresponds to one of the events.</li>
<li><b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b> is a template class that is implements the required interface of the <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> class. By itself, objects of the class <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> cannot be created because it is an interface and it does not have all the necessary information about the type of instance it will store. <b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b> fully corresponds to the description of <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b>, the only thing that distinguishes it is the <b><a class="el" href="classwpp_1_1Object.html#a2905bb68695e421c76ed3e0740bb4089" title="Creates an instance of the object.">wpp::Object::createInstance()</a></b> method implemented from the <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> interface. It should be clarified here that <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> and <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> are only interfaces that encapsulate a similar part of the code for all objects and provide the user with a unified access interface, but are not the final implementation of the object or its instance, because in order to be the final implementation of an object, needs to know the exact type of the <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>, and for different <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b>, <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> have different implementations and, accordingly, type. That is why there is <b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b>, which is a template class, thanks to which it is possible to create instances of a specialized type, and is the final implementation of the <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b> interface. When <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b> initializes its list of objects, it creates instances of exactly <b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b> to which it transfers the type of the final implementation of the instance, that is, the type of the class that implements <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>. For more information follow the link <b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b>.</li>
<li><b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> this class defines the interface and common behavior for all instances of the LwM2M object. Inheritors of this class are created in <b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b>, the type of the inheritor <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> is specified as a template parameter for <b><a class="el" href="classwpp_1_1ObjectImpl.html" title="The ObjectImpl class is a template class that represents an implementation of an object in the Wakaam...">wpp::ObjectImpl</a></b>. <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> is a container for object resource data <a href="https://openmobilealliance.org/release/LightweightM2M/V1_1_1-20190617-A/OMA-TS-LightweightM2M_Core-V1_1_1-20190617-A.pdf"><b>7.1. Resource Model</b></a>. As it was already indicated, <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> contains a list of all resources (instances of the <b><a class="el" href="classwpp_1_1Resource.html" title="The Resource class in the wpp namespace is a comprehensive and flexible class designed to handle diff...">wpp::Resource</a></b> class) for a specific <b>LwM2M</b> object, these resources are its main value because it is thanks to the data which are stored in <b><a class="el" href="classwpp_1_1Resource.html" title="The Resource class in the wpp namespace is a comprehensive and flexible class designed to handle diff...">wpp::Resource</a></b>, the server can control the client and see its state. <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> is the only place to store data for an instance of an object, therefore, accordingly, it has two interfaces: for processing requests from the server and the second for processing requests from the user. Only the user interface will be considered, since it will be used when interacting with <b>Wpp</b>. So, the user interface can be divided into two parts, the first part allows to get information about the instance (to which object belongs, its ID), the second part is methods that allows to set, get and delete the value of a specific resource. To access these resources, the approach of get/set methods is used, in which the ID of the resource to be get or set is transferred. <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> uses two approaches to set resource values, with and without copying <b>wpp::Instance::set(..., const T &amp;value)</b>. If <b>wpp::Instance::set(..., const T &amp;value)</b>, then one copy will be stored on the user side and another in <b><a class="el" href="classwpp_1_1Resource.html" title="The Resource class in the wpp namespace is a comprehensive and flexible class designed to handle diff...">wpp::Resource</a></b>. If <b>wpp::Instance::set(..., T &amp;&amp;value)</b> method, copies will not be created, data is moved to <b><a class="el" href="classwpp_1_1Resource.html" title="The Resource class in the wpp namespace is a comprehensive and flexible class designed to handle diff...">wpp::Resource</a></b> without creating a copy. There are two types of resources <b>SINGLE</b> and <b>MULTIPLE</b>, these types indicate whether the resource can store only one value or more (actually an array of values). If <b><a class="el" href="classwpp_1_1Resource.html" title="The Resource class in the wpp namespace is a comprehensive and flexible class designed to handle diff...">wpp::Resource</a></b> is <b>MULTIPLE</b>, <b><a class="el" href="classwpp_1_1ResourceContainer.html#a70cae03dc58a418193aa6ed651f224fb" title="Remove all instances.">wpp::Instance::clearRes()</a></b> and <b><a class="el" href="classwpp_1_1ResourceContainer.html#a66cad6a3caca6d213aae168cdbae421b" title="Remove resource instance if resource is MULTIPLE and instance exists, if the resource is SINGLE remov...">wpp::Instance::removeRes()</a></b> methods can be useful, because they allow you to clear an array of values entirely <b><a class="el" href="classwpp_1_1ResourceContainer.html#a70cae03dc58a418193aa6ed651f224fb" title="Remove all instances.">wpp::Instance::clearRes()</a></b>, or to remove a specific value <b><a class="el" href="classwpp_1_1ResourceContainer.html#a66cad6a3caca6d213aae168cdbae421b" title="Remove resource instance if resource is MULTIPLE and instance exists, if the resource is SINGLE remov...">wpp::Instance::removeRes()</a></b>. The interface and features for <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> have been described, now it is worth describing the method of notifying the user about events and their types. <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> there are two types of events: notifications about operations from the server side (<b>ItemOp::TYPE type</b>) and event notifications are inherent in the implementation of <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>, their presence and purpose is determined by the implementation itself. The observation approach is the same as for <b><a class="el" href="classwpp_1_1Object.html" title="The Object class implements manipulation with Instance interface class and its inheritors.">wpp::Object</a></b>, there is a class <b><a class="el" href="classwpp_1_1InstSubject.html" title="The InstSubject class represents a subject that allows subscribers to be notified about various event...">wpp::InstSubject</a></b> from which <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> is inherited, through inheritance <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b> gets two methods that allow the user to subscribe to server operations <b><a class="el" href="classwpp_1_1InstSubject.html#a97b1562a118301ae6943c22d4f7c3590" title="Subscribes an observer to receive notifications about instance resource operations.">wpp::InstSubject::opSubscribe()</a></b> and to custom events <b><a class="el" href="classwpp_1_1InstSubject.html#a392475c0827cea7289073b907d25c699" title="Subscribes an observer to receive notifications about custom instance events.">wpp::InstSubject::eventSubscribe()</a></b>. For observation, the user must implement one of the observer interfaces, <b><a class="el" href="classwpp_1_1InstOpObserver.html" title="The InstOpObserver class is an abstract base class that defines the interface for observing instance ...">wpp::InstOpObserver</a></b> for observing server operations, <b><a class="el" href="classwpp_1_1InstEventObserver.html" title="The InstEventObserver class is an abstract base class that defines the interface for observing instan...">wpp::InstEventObserver</a></b> for observing custom events <b><a class="el" href="classwpp_1_1Instance.html" title="Instance is interface class that implements manipulation with derived class resources....">wpp::Instance</a></b>.</li>
</ol>
<div class="image">
<img src="wpp_relationship_and_structure.jpg" alt="" width="650px"/>
</div>
<h3><a class="anchor" id="arch_platform_dependent"></a>
Platform Dependencies</h3>
<p>The <b>Platform Dependencies</b> interface consists of three classes <b><a class="el" href="classwpp_1_1WppConnection.html">wpp::WppConnection</a></b>, <b><a class="el" href="classwpp_1_1WppPlatform.html" title="The WppPlatform class provides a platform-specific implementation for the Wpp library.">wpp::WppPlatform</a></b>, <b><a class="el" href="classwpp_1_1WppGuard.html" title="The WppGuard class provides a linker callback class that must be implemented by the user.">wpp::WppGuard</a></b>. Each of these classes is an interface that must be implemented by the user. An example of the implementation can be found <a href="../../examples/platform"><b>here</b></a>. The <b><a class="el" href="classwpp_1_1WppGuard.html" title="The WppGuard class provides a linker callback class that must be implemented by the user.">wpp::WppGuard</a></b> class is responsible for providing synchronization mechanisms for accessing shared resources. It provides methods to lock, unlock, and try_lock the guard object. The user must implement these methods according to their specific synchronization requirements. <b><a class="el" href="classwpp_1_1WppPlatform.html" title="The WppPlatform class provides a platform-specific implementation for the Wpp library.">wpp::WppPlatform</a></b> uses the Linker Callback pattern the same as <b><a class="el" href="classwpp_1_1WppGuard.html" title="The WppGuard class provides a linker callback class that must be implemented by the user.">wpp::WppGuard</a></b>, where the implementation of methods is carried out on the user side. It provides functions for retrieving the elapsed time, printing messages, and simplifying the usage of the print function. <b><a class="el" href="classwpp_1_1WppConnection.html">wpp::WppConnection</a></b> provides an abstract interface for establishing and managing connections in the <b>Wpp</b>. It defines pure virtual methods that must be implemented by the user to establish a connection, disconnect, compare session identifiers, and send packets over the connection. The <b><a class="el" href="classwpp_1_1WppConnection.html">wpp::WppConnection</a></b> class also provides methods for adding packets to a queue, retrieving the size of the packet queue, clearing the packet queue, and setting/getting the COAP block size.</p>
<h3><a class="anchor" id="arch_wpp_task_queue"></a>
Wpp Task Queue</h3>
<p><b>Wpp Task Queue</b> tool for planning and executing tasks in the context of <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b>. As described in the section <a class="el" href="architecture_tag.html#arch_client_state_management">**State Management**</a> the client can be owned by only one program subject at a time, but what if it is necessary to make changes to the registry when the registry is already owned? You can call the <b><a class="el" href="classwpp_1_1WppClient.html#ac8e1eb3f8542f0f0f93f3abf897a70da" title="Takes ownership of the WppClient, blocking until it becomes available.">wpp::WppClient::takeOwnershipBlocking()</a></b> method, but in this case the execution of the thread will be blocked until the client is released, but if blocking or any waiting is not allowed, then you can schedule a task in the context <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b>. This is only one of the problems that <b><a class="el" href="classwpp_1_1WppTaskQueue.html" title="Represents a task queue.">wpp::WppTaskQueue</a></b> solves, also its functionality allows to schedule cyclic tasks, or tasks that must be performed before a specific condition occurs. A more detailed description of its capabilities and use can be found at the following link <b><a class="el" href="classwpp_1_1WppTaskQueue.html" title="Represents a task queue.">wpp::WppTaskQueue</a></b>. It is worth noting several features of the <b><a class="el" href="classwpp_1_1WppTaskQueue.html" title="Represents a task queue.">wpp::WppTaskQueue</a></b> implementation for a better understanding of its operation. The created tasks are processed all together sequentially, at the time of calling <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b>, so the frequency of calling tasks depends on the frequency of calling the <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> method, but this does not mean, that <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b> must be called continuously because the granularity of deferred task invocation is measured in seconds. <b><a class="el" href="classwpp_1_1WppTaskQueue.html" title="Represents a task queue.">wpp::WppTaskQueue</a></b> does not guarantee that the task will be called on time, the only guarantee is that the tasks will not be called before the specified time. Each task is called in the context of <b><a class="el" href="classwpp_1_1WppClient.html" title="Represents a client interface for Wpp library.">wpp::WppClient</a></b>, which means that the user cannot make changes to the registry at this time, the executed task is actually the sole owner of the registry. From the context of the task, you can safely use the <b><a class="el" href="classwpp_1_1WppTaskQueue.html" title="Represents a task queue.">wpp::WppTaskQueue</a></b> interface to create new tasks, delete them, and get the status. If a task is created from the context of an executed task or during task processing, then it can be executed only at the next call to <b><a class="el" href="classwpp_1_1WppClient.html#aafd44d1c81f8ee217675bcd27173b67f" title="Processes the state of the Wakaama core. This function performs the necessary work by the Wakaama cor...">wpp::WppClient::loop()</a></b>, if a request was created to delete a task that is currently being executed, then the removal process will only happen after the execution is complete. If another task is deleted from the execution environment or elsewhere, and it has not yet been executed, then it will be deleted without execution. The task that is being executed must not contain delays or blocks in its code, as this will delay the execution of all other tasks and the processing of the client's state.</p>
<h3><a class="anchor" id="arch_integration_and_flexibility"></a>
Integration and Flexibility</h3>
<p><b>Wpp's</b> architecture allows for easy integration into new environments and the possibility to implementation <b>Platform dependent interface</b> as per environmental requirements. This flexibility is attributed to the absence of external dependencies, as <b>Wpp</b> defines all input and output interfaces, and the environment implements them. For integration to new environment user should implement the next interfaces: <b><a class="el" href="classwpp_1_1WppConnection.html">wpp::WppConnection</a></b>, <b><a class="el" href="classwpp_1_1WppPlatform.html" title="The WppPlatform class provides a platform-specific implementation for the Wpp library.">wpp::WppPlatform</a></b>, <b><a class="el" href="classwpp_1_1WppGuard.html" title="The WppGuard class provides a linker callback class that must be implemented by the user.">wpp::WppGuard</a></b>. Example can be found in the <a href="../../examples/platform"><b>platform</b></a> folder.</p>
<h3><a class="anchor" id="arch_object_maker_tools"></a>
Object Maker Tools</h3>
<p>As mentioned in the section <a class="el" href="architecture_tag.html#arch_registry_management">Registry Management</a>, for <b>Wpp</b> a complex of utilities <a href="../../utils/object_maker"><b>object_maker</b></a> has been developed for generation, integration, deletion and update of objects in the form of source code. <a href="../../utils/object_maker"><b>object_maker</b></a> is not a critically important part of <b>Wpp</b> without which the creation of new objects is impossible, it is more of an auxiliary character to simplify tasks related to the modification of the object registry. Let's consider in more detail the capabilities of <a href="../../utils/object_maker"><b>object_maker</b></a>:</p><ol type="1">
<li>Object generation. To generate a utility object, you must have its description in the form of a **.xml** file (more details on the format can be found <a href="https://github.com/OpenMobileAlliance/lwm2m-registry?tab=readme-ov-file# 3-create-a-new-object">here</a>), the file can be presented locally or as a URL link. As a result of generation, a folder is created with the source code for the object that needs to be integrated into <b>Wpp</b>. The created folder contains 5 files with code and <b>object_metadata.json</b> with metadata that is necessary in the other utils.</li>
<li>Integration of the object. To integrate the utility must know the path to the folder with the description of the object. As a result of the integration, the folder is copied to <a href="../../wpp/registry/objects"><b>objects</b></a> and the object is added to <b><a class="el" href="classwpp_1_1WppRegistry.html" title="The WppRegistry class represents a registry for managing LWM2M objects.">wpp::WppRegistry</a></b>, after which the user can use the corresponding object in their code.</li>
<li>Deleting the object. To delete the utility must obtain the path to the folder of the corresponding object in <a href="../../wpp/registry/objects"><b>objects</b></a>, after which the specified object will be deleted from <b>Wpp</b>.</li>
<li>Updating the object. To update the utility must receive two parameters: the path to the **.xml** file with the updated description of the object and the path to the folder of the corresponding object in <a href="../../wpp/registry/objects"><b>objects</b></a>. The main task of this utility is to transfer the implementation from the old version of the object to the new one. It is not recommended to be used without a critical need and understanding of the consequences.</li>
</ol>
<h3><a class="anchor" id="arch_summary"></a>
Summary</h3>
<p>The architecture of <b>Friendly LWM2M client (Wpp)</b> is a well-structured framework that provides a robust platform for the development and implementation of LwM2M client applications. It maintains a balance between high-level functionality and control, and is designed to be flexible and adaptable to various user and environmental needs. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
